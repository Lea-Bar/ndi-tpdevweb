---
// fichier : src/components/OceanBall.astro

import OceanStats from './OceanStats.astro'; // Importation du composant OceanStats

const { ocean } = Astro.props;

let showStats = false; // État interne pour afficher/masquer les statistiques

// Extraire le taux de pollution de l'objet ocean
const tauxDePollution = ocean.tauxDePollution;

// Convertir le taux de pollution en nombre
const pollutionNumber = parseInt(tauxDePollution, 10);

// Fonction pour déterminer la couleur en fonction du taux de pollution
const getBallColor = (pollution: number) => {
  if (pollution >= 100) return "black";  // Très haute pollution
  if (pollution >= 80) return "grey";    // Pollution élevée
  if (pollution >= 60) return "red";     // Pollution élevée
  if (pollution >= 40) return "orange";  // Pollution modérée
  if (pollution >= 20) return "yellow";  // Pollution faible
  return "darkgreen";                    // Pas de pollution
};

const ballColor = getBallColor(pollutionNumber);

---

<div id="pollutionBall" class="pollution-ball" style={`background-color: ${ballColor};`}></div>

{showStats && <OceanStats ocean={ocean} />}

<script type="module">
  // JavaScript côté client pour écouter l'événement de clic
  document.addEventListener('DOMContentLoaded', () => {
    const ball = document.getElementById('pollutionBall');
    let showStats = false; // Variable pour basculer l'état

    if (ball) {
      ball.addEventListener('click', () => {
        showStats = !showStats;
        console.log(ball+" "+showStats);
        // Met à jour l'affichage des statistiques en fonction du nouvel état
        document.querySelector('ocean-stats').style.display = showStats ? 'block' : 'none';
      });
    }
  });
</script>

<style>
  .pollution-ball {
    width: 100px;
    height: 100px;
    border-radius: 50%;
    transition: background-color 0.5s ease;
    cursor: pointer;
  }

  .ocean-stats {
    padding: 20px;
    background-color: #f0f0f0;
    border: 1px solid #ddd;
    margin-top: 10px;
  }

  .ocean-stats a {
    color: #0077cc;
    text-decoration: none;
  }

  .ocean-stats a:hover {
    text-decoration: underline;
  }
</style>
